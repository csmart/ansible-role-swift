---
- hosts: localhost
  tasks:
  - name: Create rings
    swift_ring:
      name: "{{ item.key }}"
      backup: false
      create: true
      min_part_hours: "{{ item.value['min_part_hours'] | default(0) }}"
      part_power: "{{ item.value['part_power'] }}"
      path: "{{ item.value['path'] }}"
      rebalance: true
      replicas: 3
      validate: true
    register: result_rings
    with_dict:
      - "{{ swift_account_rings }}"
      - "{{ swift_container_rings }}"
      - "{{ swift_object_rings }}"

  - name: Print result
    debug:
      msg: '{{ result_rings }}'

  - name: Full rings at once
    swift_ring:
      name: "{{ item.key }}"
      devices: "{{ swift_devices }}"
      path: "{{ item.value['path'] }}"
      rebalance: true
      validate: true
    register: result_rings
    with_dict:
      - "{{ swift_account_rings }}"
      - "{{ swift_container_rings }}"
      - "{{ swift_object_rings }}"

  - name: Print result
    debug:
      msg: '{{ result_rings }}'
